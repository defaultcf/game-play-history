name: collect
on: push
#on:
#  schedule:
#    - cron: '0 14 */7 * *'
jobs:
  collect_info:
    runs-on: ubuntu-18.04
    steps:
      - uses: actions/checkout@v2
      - name: Install dependencies
        run: |
          sudo apt install jq
      - name: Fetch info
        env:
          STEAM_APIKEY: ${{ secrets.STEAM_APIKEY }}
          STEAM_ID: ${{ secrets.STEAM_ID }}
        run: |
          curl "https://api.steampowered.com/IPlayerService/GetOwnedGames/v0001/?key=${STEAM_APIKEY}&steamid=${STEAM_ID}&include_appinfo=1" | jq .response.games > src/data/history.json
      - name: Commit
        uses: stefanzweifel/git-auto-commit-action@v4
